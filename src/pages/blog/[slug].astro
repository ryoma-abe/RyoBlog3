---
import Layout from "../../layouts/Layout.astro";
import { getNotionPosts } from "../../lib/notion";
import type { PageObjectResponse } from "@notionhq/client/build/src/api-endpoints";

export async function getStaticPaths() {
  const posts = await getNotionPosts();
  return posts.map((post: PageObjectResponse) => {
    const slug =
      (post.properties.slug as any)?.rich_text?.[0]?.plain_text || "no-slug";
    return {
      params: { slug },
      props: { post },
    };
  });
}

const { post } = Astro.props;
const title = (post.properties.Name as any)?.title?.[0]?.plain_text || "無題";
const tags = (post.properties.tags as any)?.multi_select || [];
const date = (post.properties.date as any)?.date?.start || "";
---

<Layout title={title}>
  <article class="max-w-4xl mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-4">{title}</h1>
    <div class="flex gap-2 mb-4">
      {
        tags.map((tag: { name: string }) => (
          <span class="text-sm px-3 py-1 rounded-full bg-gray-200">
            {tag.name}
          </span>
        ))
      }
    </div>
    <time class="text-gray-500">{date}</time>
    <div class="prose mt-8">
      {/* ここに記事の本文を表示する処理を追加 */}
    </div>
  </article>
</Layout>

